# ç¾…æŠ€è£ç½®é›»æ± ç›£æ§è¨­å®šæŒ‡å—

æœ¬æŒ‡å—èªªæ˜å¦‚ä½•ç‚ºç¾…æŠ€ç„¡ç·šè£ç½®ï¼ˆå¦‚ G535ã€G733 ç­‰ï¼‰å•Ÿç”¨é›»æ± ç›£æ§åŠŸèƒ½ã€‚

## èƒŒæ™¯èªªæ˜

ç¾…æŠ€ USB ç„¡ç·šè£ç½®ä½¿ç”¨å°ˆæœ‰çš„ HID++ å”è­°ï¼Œç„¡æ³•é€é Windows æ¨™æº– API æŸ¥è©¢é›»æ± ç‹€æ…‹ã€‚å› æ­¤éœ€è¦ä½¿ç”¨ç¬¬ä¸‰æ–¹å·¥å…· **LGSTray** ä¾†æä¾›é›»æ± è³‡è¨Šã€‚

## å®‰è£æ­¥é©Ÿ

### 1. ä¸‹è¼‰ LGSTray

å‰å¾€ GitHub ç™¼å¸ƒé é¢ä¸‹è¼‰æœ€æ–°ç‰ˆæœ¬ï¼š
ğŸ‘‰ https://github.com/andyvorld/LGSTrayBattery/releases

ä¸‹è¼‰ä¸¦è§£å£“ç¸® `LGSTray-win-x64.zip`ï¼ˆåŒ…å« LGSTray.exe å’Œç›¸é—œæª”æ¡ˆï¼‰

### 2. æ”¾ç½®æª”æ¡ˆ

å°‡è§£å£“ç¸®çš„æ‰€æœ‰æª”æ¡ˆæ”¾åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„ï¼š

```
E:\VScode\selftool\
â”œâ”€â”€ LGSTray.exe           â† ä¸»ç¨‹å¼
â”œâ”€â”€ LGSTrayHID.exe        â† HID é©…å‹•
â”œâ”€â”€ LGSTray.pdb          â† é™¤éŒ¯ç¬¦è™Ÿ
â”œâ”€â”€ LGSTrayCore.pdb
â”œâ”€â”€ LGSTrayHID.pdb
â”œâ”€â”€ LGSTrayPrimitives.pdb
â”œâ”€â”€ src\
â”œâ”€â”€ start_logitech.bat   â† ä½¿ç”¨é€™å€‹ï¼
â””â”€â”€ ...
```

### 3. ä½¿ç”¨å•Ÿå‹•è…³æœ¬

ä½¿ç”¨æä¾›çš„ `start_logitech.bat` å•Ÿå‹•ç¨‹å¼ï¼š

1. é›™æ“Š `start_logitech.bat`
2. è…³æœ¬æœƒè‡ªå‹•ï¼š
   - æª¢æŸ¥ LGSTray æ˜¯å¦å·²åŸ·è¡Œ
   - å¦‚æœæœªåŸ·è¡Œï¼Œè‡ªå‹•å•Ÿå‹•å®ƒ
   - ç­‰å¾… 3 ç§’è®“ LGSTray åˆå§‹åŒ–
   - å•Ÿå‹•éŸ³è¨Šåˆ‡æ›å·¥å…·

**å°±é€™éº¼ç°¡å–®ï¼ä¸€å€‹æ‰¹æ¬¡æª”æå®šæ‰€æœ‰äº‹æƒ…ã€‚**

## âœ… é©—è­‰è¨­å®š

åŸ·è¡Œ `test_lgstray.bat` ä¾†æ¸¬è©¦ LGSTray æ˜¯å¦æ­£å¸¸é‹ä½œï¼š
- âœ… æª¢æŸ¥ LGSTray åŸ·è¡Œç‹€æ…‹
- âœ… æ¸¬è©¦ API é€£ç·š
- âœ… é¡¯ç¤ºæ‰€æœ‰è£ç½®çš„é›»æ± è³‡è¨Š

å¦‚æœçœ‹åˆ°é¡ä¼¼ä»¥ä¸‹è¼¸å‡ºï¼Œè¡¨ç¤ºè¨­å®šæˆåŠŸï¼š
```
[OK] LGSTray is running
[OK] API connection successful!
æ‰¾åˆ° 3 å€‹è£ç½®:
1. G535 Gaming Headset
   é›»æ± : 80.0%
   å……é›»ä¸­: å¦
```

## åŠŸèƒ½èªªæ˜

### è‡ªå‹•åµæ¸¬

ç¨‹å¼æœƒè‡ªå‹•åµæ¸¬ LGSTray æ˜¯å¦åŸ·è¡Œï¼š

- âœ… **LGSTray åŸ·è¡Œä¸­**ï¼šé¡¯ç¤ºç¾…æŠ€è£ç½®é›»æ± è³‡è¨Šï¼ˆ80%ï¼‰
- âš ï¸ **LGSTray æœªåŸ·è¡Œ**ï¼šé€€å›åˆ°æ¨™æº–è—ç‰™æŸ¥è©¢ï¼ˆå¯èƒ½ç„¡æ³•é¡¯ç¤ºç¾…æŠ€è£ç½®ï¼‰

### æ‰˜ç›¤é¸å–®é¡¯ç¤º

å³éµé»æ“Šç³»çµ±æ‰˜ç›¤åœ–ç¤ºï¼Œæœƒçœ‹åˆ°ï¼š

```
ğŸ”‹ Logitech G535 Gaming Headset: 85%
```

é›»æ± åœ–ç¤ºèªªæ˜ï¼š
- ğŸ”Œ å……é›»ä¸­
- ğŸ”‹ é›»é‡å……è¶³ï¼ˆ>= 50%ï¼‰
- ğŸª« é›»é‡ä¸è¶³ï¼ˆ< 50%ï¼‰

**é›»é‡è³‡è¨Šæœƒåœ¨æ¯æ¬¡æ‰“é–‹å³éµé¸å–®æ™‚è‡ªå‹•æ›´æ–°**ï¼Œç„¡éœ€æ‰‹å‹•åˆ·æ–°ã€‚

## æ•…éšœæ’é™¤

### Q: é¡¯ç¤ºã€Œè€³æ©Ÿ: ä¸æ”¯æ´æˆ–æœªé€£æ¥ã€

**æª¢æŸ¥æ¸…å–®ï¼š**
1. âœ… LGSTray.exe æ˜¯å¦æ­£åœ¨åŸ·è¡Œï¼Ÿ
   - æª¢æŸ¥ç³»çµ±æ‰˜ç›¤æ˜¯å¦æœ‰ LGSTray åœ–ç¤º
   - æˆ–ä½¿ç”¨å·¥ä½œç®¡ç†å“¡æŸ¥çœ‹
   - **åŸ·è¡Œ `test_lgstray.bat` é€²è¡Œè¨ºæ–·**

2. âœ… ç¾…æŠ€è£ç½®æ˜¯å¦å·²é€£æ¥ä¸¦é–‹æ©Ÿï¼Ÿ
   - ç¢ºèªè£ç½®å·²é€£æ¥åˆ°é›»è…¦
   - ç¢ºèªè£ç½®å·²é–‹æ©Ÿ

3. âœ… LGSTray API æ˜¯å¦å¯è¨ªå•ï¼Ÿ
   - é–‹å•Ÿç€è¦½å™¨è¨ªå• http://localhost:12321/
   - æ‡‰è©²èƒ½çœ‹åˆ°è£ç½®åˆ—è¡¨ HTML é é¢
   - åŸ·è¡Œ `test_lgstray.bat` æœƒè‡ªå‹•æ¸¬è©¦

### Q: LGSTray ç„¡æ³•å•Ÿå‹•

**å¯èƒ½åŸå› ï¼š**
- éœ€è¦ .NET Runtimeï¼ˆé€šå¸¸ Windows 10/11 å·²å…§å»ºï¼‰
- é˜²ç«ç‰†æˆ–é˜²æ¯’è»Ÿé«”é˜»æ“‹
- ç¾…æŠ€è£ç½®é©…å‹•æœªæ­£ç¢ºå®‰è£

**è§£æ±ºæ–¹æ³•ï¼š**
1. å®‰è£æœ€æ–°çš„ [.NET Runtime](https://dotnet.microsoft.com/download/dotnet/8.0)
2. æª¢æŸ¥é˜²ç«ç‰†è¨­å®šï¼Œå…è¨± LGSTray
3. å®‰è£æˆ–æ›´æ–°ç¾…æŠ€ G HUB é©…å‹•ç¨‹å¼

### Q: èƒ½å¦å–®ç¨ä½¿ç”¨ LGSTray æŸ¥çœ‹é›»é‡ï¼Ÿ

å¯ä»¥ï¼LGSTray æœ¬èº«å°±æ˜¯ä¸€å€‹ç¨ç«‹çš„é›»æ± ç›£æ§å·¥å…·ï¼Œæœƒåœ¨ç³»çµ±æ‰˜ç›¤é¡¯ç¤ºé›»æ± ç™¾åˆ†æ¯”ã€‚æœ¬å°ˆæ¡ˆåªæ˜¯æ•´åˆäº†å®ƒçš„ HTTP API ä¾†æä¾›çµ±ä¸€çš„ä»‹é¢ã€‚

## æŠ€è¡“ç´°ç¯€

### HTTP API ç«¯é»

LGSTray æä¾› HTTP APIï¼ˆXML æ ¼å¼ï¼‰ï¼š

**ç«¯é»ï¼š** `GET http://localhost:12321/device/{device_name}`

**ç¯„ä¾‹ï¼š** `GET http://localhost:12321/device/G535%20Gaming%20Headset`

**å›æ‡‰ç¯„ä¾‹ï¼š**
```xml
<?xml version="1.0" encoding="UTF-8"?>
<xml>
  <device_id>dev00000000</device_id>
  <device_name>G535 Gaming Headset</device_name>
  <device_type>Headset</device_type>
  <battery_percent>80.00</battery_percent>
  <battery_voltage>0.00</battery_voltage>
  <mileage>30.71</mileage>
  <charging>False</charging>
  <last_update>10/22/2025 20:51:24 -06:00</last_update>
</xml>
```

**è£ç½®åˆ—è¡¨ç«¯é»ï¼š** `GET http://localhost:12321/`ï¼ˆè¿”å› HTML æ ¼å¼çš„è£ç½®åˆ—è¡¨ï¼‰

### ç¨‹å¼æ¶æ§‹

```
src/battery/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ bluetooth_battery.py      # æ¨™æº–è—ç‰™æŸ¥è©¢ï¼ˆä¸æ”¯æ´ç¾…æŠ€ USB ç„¡ç·šï¼‰
â””â”€â”€ logitech_battery.py        # LGSTrayBattery API æ•´åˆ

src/main.py
â””â”€â”€ get_headset_battery_text()
    â”œâ”€â”€ 1. å˜—è©¦ LGSTrayBattery APIï¼ˆå„ªå…ˆï¼‰
    â””â”€â”€ 2. é€€å›åˆ°æ¨™æº–è—ç‰™æŸ¥è©¢
```

## å…¶ä»–è³‡æº

- **LGSTrayBattery GitHub**: https://github.com/andyvorld/LGSTrayBattery
- **HID++ å”è­°æ–‡æª”**: https://github.com/Logitech/hidpp
- **å¯è¡Œæ€§ç ”ç©¶å ±å‘Š**: `docs/reports/logitech_battery_integration_feasibility.md`

## æˆæ¬Šè²æ˜

LGSTrayBattery æ˜¯ç¨ç«‹çš„é–‹æºå°ˆæ¡ˆï¼Œæœ¬å°ˆæ¡ˆåƒ…ä½¿ç”¨å…¶ HTTP APIã€‚è«‹åƒé–± LGSTrayBattery çš„æˆæ¬Šæ¢æ¬¾ã€‚
