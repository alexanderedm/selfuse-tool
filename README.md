# 音訊輸出裝置快速切換工具

一個輕量級的 Windows 系統托盤工具，讓你能快速在兩個預設的音訊輸出裝置之間切換。

## 功能特色

- 🎧 **一鍵切換**: 在兩個預設音訊裝置間快速切換
- 🖼️ **系統托盤整合**: 常駐系統托盤，不占用桌面空間
- 🎨 **視覺回饋**:
  - 切換時顯示通知訊息
  - 托盤圖示顏色隨當前裝置改變
- ⚙️ **簡單設定**: 圖形化設定介面，輕鬆選擇要切換的裝置
- 🚀 **開機自啟動**: 可選擇隨 Windows 開機啟動
- 💾 **記憶設定**: 所有設定持久化儲存，重開機後保留

## 系統需求

- Windows 10/11 (或 Windows 7/8，但部分功能可能不穩定)
- Python 3.8 或更高版本

## 安裝步驟

### 方法 1: 使用原始碼

1. 克隆或下載此專案
2. 安裝依賴套件:
```bash
pip install -r requirements.txt
```

3. 執行程式:
```bash
python main.py
```

### 方法 2: 使用打包的執行檔 (待發布)

直接下載 `AudioSwitcher.exe` 並執行即可。

## 使用說明

### 首次使用

1. 執行程式後，系統托盤會出現一個圖示
2. 右鍵點擊圖示，選擇「設定」
3. 在設定視窗中選擇兩個要切換的音訊裝置 (裝置 A 和 裝置 B)
4. 點擊「儲存」

### 日常使用

- **切換裝置**: 右鍵點擊托盤圖示 → 選擇「切換輸出裝置」
- **修改設定**: 右鍵點擊托盤圖示 → 選擇「設定」
- **開機自啟動**: 右鍵點擊托盤圖示 → 勾選「開機自動啟動」
- **結束程式**: 右鍵點擊托盤圖示 → 選擇「結束」

### 托盤圖示顏色說明

- 🔵 **藍色**: 目前使用裝置 A
- 🟢 **綠色**: 目前使用裝置 B
- ⚫ **灰色**: 使用其他裝置或未設定

## 專案結構

```
selftool/
├── main.py              # 主程式進入點
├── audio_manager.py     # 音訊裝置管理模組
├── config_manager.py    # 設定檔管理模組
├── settings_window.py   # 設定視窗模組
├── config.json          # 設定檔 (自動生成)
├── requirements.txt     # Python 依賴套件
├── README.md           # 本文件
└── PRD.md              # 產品需求文件
```

## 技術細節

### 使用的技術棧

- **pystray**: 系統托盤功能
- **pycaw**: Windows 音訊控制
- **tkinter**: 設定介面 (Python 內建)
- **comtypes**: COM 介面操作
- **pywin32**: Windows API

### 運作原理

本工具使用 Windows 的 PolicyConfig COM 介面來切換預設音訊裝置，相容 Windows 7/8/10/11。

## 打包成執行檔 (可選)

如果想要打包成單一執行檔:

```bash
pip install pyinstaller
pyinstaller --onefile --windowed --icon=icon.ico --name=AudioSwitcher main.py
```

生成的 `AudioSwitcher.exe` 會在 `dist` 資料夾中。

## 常見問題

**Q: 為什麼切換後沒有反應?**
A: 請確認：
1. 已在設定中選擇兩個不同的裝置
2. 選擇的裝置目前是啟用狀態
3. 以管理員權限執行程式

**Q: 能否支援超過兩個裝置?**
A: 目前版本僅支援兩個裝置間切換，這是為了保持簡單易用。未來版本可能會加入更多裝置支援。

**Q: 開機自啟動沒有作用?**
A: 請檢查 Windows 工作管理員 → 啟動項目，確認 AudioSwitcher 是否已加入。

## 授權

MIT License

## 貢獻

歡迎提交 Issue 或 Pull Request！

## 更新日誌

### v1.0.0 (2025-10-04)
- 初始版本發布
- 支援雙裝置快速切換
- 系統托盤整合
- 圖形化設定介面
- 開機自啟動功能
